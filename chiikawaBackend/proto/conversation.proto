syntax = "proto3";

package conversation;

// 对话角色
enum ConversationMessageRole {
  CONVERSATION_MESSAGE_ROLE_UNSPECIFIED = 0;
  CONVERSATION_MESSAGE_ROLE_SYSTEM = 1;
  CONVERSATION_MESSAGE_ROLE_USER = 2;
  CONVERSATION_MESSAGE_ROLE_ASSISTANT = 3;
  CONVERSATION_MESSAGE_ROLE_TOOL = 4;
}

// 会话消息
message ConversationMessage {
  // 消息 ID
  string id = 1;

  // 会话 ID
  string session_id = 2;

  // 在会话中的顺序索引
  int32 index = 3;

  // 完整 UIMessage 的 JSON 序列化
  string ui_message_json = 4;

  // 创建 / 更新时间（毫秒时间戳）
  int64 created_at = 5;
  int64 updated_at = 6;

  // 可选的额外元数据（
  map<string, string> metadata = 7;
}

// 会话来源渠道
enum ConversationChannel {
  CONVERSATION_CHANNEL_UNSPECIFIED = 0;
  CONVERSATION_CHANNEL_WEB_CHAT = 1;
  CONVERSATION_CHANNEL_VOICE = 2;
  CONVERSATION_CHANNEL_API = 3;
}

// 会话状态
enum ConversationStatus {
  CONVERSATION_STATUS_UNSPECIFIED = 0;
  CONVERSATION_STATUS_ACTIVE = 1;
  CONVERSATION_STATUS_ENDED = 2;
  CONVERSATION_STATUS_ARCHIVED = 3;
}

// 会话实体
message ConversationSession {
  string session_id = 1;
  optional string user_id = 2;
  optional string tenant_id = 3;
  ConversationChannel channel = 4;
  optional string title = 5;
  optional bool deleted = 6;
  int64 started_at = 7; // Unix timestamp in milliseconds
  int64 last_message_at = 8; // Unix timestamp in milliseconds
  int64 created_at = 9; // Unix timestamp in milliseconds
  int64 updated_at = 10; // Unix timestamp in milliseconds
  map<string, string> metadata = 11; // JSON string values
}

